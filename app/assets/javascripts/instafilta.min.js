/*!
 * instaFilta
 * Version: 1.4
 * Description: jQuery plugin for performing in-page filtering
 * Homepage and documentation: https://github.com/chromawoods/instaFilta
 * Author: Andreas Larsson <andreas@chromawoods.com> (http://chromawoods.com)
 * Contributions: Jaap-Jan Frans
 */
!function(t){t.fn.instaFilta=function(e){var s=null,i=null,a=t.extend({scope:null,targets:".instafilta-target",sections:".instafilta-section",categoryDataAttr:"instafilta-category",matchCssClass:"instafilta-match",itemsHideEffect:"hide",itemsHideDuration:0,itemsShowEffect:"show",itemsShowDuration:0,sectionsHideEffect:"hide",sectionsHideDuration:0,sectionsShowEffect:"show",sectionsShowDuration:0,onFilterComplete:null,markMatches:!1,hideEmptySections:!0,beginsWith:!1,caseSensitive:!1,typeDelay:0,useSynonyms:!0,synonyms:[{src:"à,á,å,ä,â,ã",dst:"a"},{src:"À,Á,Å,Ä,Â,Ã",dst:"A"},{src:"è,é,ë,ê",dst:"e"},{src:"È,É,Ë,Ê",dst:"E"},{src:"ì,í,ï,î",dst:"i"},{src:"Ì,Í,Ï,Î",dst:"I"},{src:"ò,ó,ö,ô,õ",dst:"o"},{src:"Ò,Ó,Ö,Ô,Õ",dst:"O"},{src:"ù,ú,ü,û",dst:"u"},{src:"Ù,Ú,Ü,Û",dst:"U"},{src:"ç",dst:"c"},{src:"Ç",dst:"C"},{src:"æ",dst:"ae"}]},e);if(a.useSynonyms)for(var n=0,r=a.synonyms.length;r>n;n++)a.synonyms[n].src=a.synonyms[n].src.split(",");return this.each(function(){var e,n,r,o,c="";a.scope?(o=t(this).closest(a.scope),n=o.find(a.targets),r=o.find(a.sections)):(n=t(a.targets),r=t(a.sections)),n.each(function(){$target=t(this),original=$target.text(),$target.data("values",function(t){var e=[original],s=original;if(!a.useSynonyms)return e;for(var i=0,n=t.length;n>i;i++)for(var r=0;r<t[i].src.length;r++)s=s.replace(t[i].src[r],t[i].dst);return!(s!==original)||e.push(s),e}(a.synonyms))});var l=function(){r.each(function(){var e=t(this);e.find('[data-instafilta-hide="false"]').length?e[a.sectionsShowEffect](a.sectionsShowDuration):e[a.sectionsHideEffect](a.sectionsHideDuration)})},f=function(t){var e=function(){return t?n.attr("data-instafilta-hide","false"):n}().filter('[data-instafilta-hide="false"]')[a.itemsShowEffect](a.itemsShowDuration);return t||n.filter('[data-instafilta-hide="true"]')[a.itemsHideEffect](a.itemsHideDuration),a.hideEmptySections&&l(),"function"==typeof a.onFilterComplete&&a.onFilterComplete.apply(this,[e]),e},u=function(){return f(!0)};s=function(e){return e=a.caseSensitive?e:e.toLowerCase(),c===e?!1:(c=e,e||u(),n.each(function(){var s=t(this);s.data("originalText")||(s.data("originalHtml",s.html()),s.data("originalText",s.data("values")[0]));var i=function(t,e){for(var s=-1,i=0;i<t.length&&(s=(a.caseSensitive?t[i]:t[i].toLowerCase()).indexOf(e),!(s>=0));i++);return s}(s.data("values"),e),n=s.data("originalText"),r=(a.caseSensitive?n:n.toLowerCase(),null),o=null;i>=0&&a.markMatches&&(r=n.substring(i,i+e.length),o=n.replace(r,'<span class="'+a.matchCssClass+'">'+r+"</span>"),s.html(s.data("originalHtml").replace(n,o))),s.attr("data-instafilta-hide",a.beginsWith&&0!==i||0>i?"true":"false")}),f())},i=function(e){var s=function(t){return(t.data(a.categoryDataAttr)||"").split(",")};return r.each(function(){var i=t(this);sectCategories=s(i),i.find(a.targets).each(function(){for(var i=t(this),a=!1,n=s(i).concat(sectCategories),r=0;r<n.length;r++)if(e===n[r].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")){a=!0;break}i.html(i.data("originalText")).attr("data-instafilta-hide",a?!1:!0)})}),e?f():u()},t(this).on("keyup",function(){var i=t(this);clearTimeout(e),e=setTimeout(function(){s(i.val())},a.typeDelay)})}),{filterTerm:s,filterCategory:i}}}(jQuery);